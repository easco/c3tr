!function(e){function t(r){if(n[r])return n[r].exports;var u=n[r]={exports:{},id:r,loaded:!1};return e[r].call(u.exports,u,u.exports,t),u.loaded=!0,u.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var u=n(1),a=r(u);window.addEventListener("load",a["default"].init)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function u(){var e=768,t=1024,n=O["default"].generate(t,e),r=O["default"].startingPosition(n);return{state:{entities:O["default"].populate(n).concat(p["default"].create(r)),messages:[],worldHeight:e,worldWidth:t},world:n}}function a(){var e=u();c(window.innerWidth,window.innerHeight),o(e),window.addEventListener("keydown",function(t){var n=void 0;switch(t.keyCode){case 77:case 81:return l();case 73:return f();case 39:case 76:n=h["default"].MOVE_EAST;break;case 38:case 75:n=h["default"].MOVE_NORTH;break;case 85:n=h["default"].MOVE_NORTHEAST;break;case 89:n=h["default"].MOVE_NORTHWEST;break;case 40:case 74:n=h["default"].MOVE_SOUTH;break;case 78:n=h["default"].MOVE_SOUTHEAST;break;case 66:n=h["default"].MOVE_SOUTHWEST;break;case 37:case 72:n=h["default"].MOVE_WEST}Boolean(n)&&(e=d(n,e),o(e))}),window.addEventListener("resize",function(){c(window.innerWidth,window.innerHeight),o(e)})}function i(e){var t=M["default"].find("#Log"),n=M["default"].html("p",{},[e]);t.insertBefore(n,t.firstChild)}function o(e){(0,R["default"])(e),(0,w["default"])(e),(0,k["default"])(e),(0,I["default"])(e)}function c(e,t){var n=M["default"].find("#Field");n.setAttribute("width",e),n.setAttribute("height",t-80)}function f(){s(M["default"].find("#Inventory"))}function l(){s(M["default"].find("#Log"))}function s(e){e.classList.contains("open")?e.classList.remove("open"):e.classList.add("open")}function d(e,t){var n=t.state,r=n.entities,u=n.entities.find(function(e){return"CARL"===e.id}),a=void 0;switch(e){case h["default"].MOVE_EAST:a=T["default"].EAST;break;case h["default"].MOVE_NORTH:a=T["default"].NORTH;break;case h["default"].MOVE_NORTHEAST:a=T["default"].NORTHEAST;break;case h["default"].MOVE_NORTHWEST:a=T["default"].NORTHWEST;break;case h["default"].MOVE_SOUTH:a=T["default"].SOUTH;break;case h["default"].MOVE_SOUTHEAST:a=T["default"].SOUTHEAST;break;case h["default"].MOVE_SOUTHWEST:a=T["default"].SOUTHWEST;break;case h["default"].MOVE_WEST:a=T["default"].WEST}a&&(u=b["default"].attach(u,x["default"].create(a)),r=r.map(function(e){return"CARL"===e.id?u:e})),n=Object.assign({},t.state,{entities:r,messages:[]}),n=A["default"].run(Object.assign({},t,{state:n})),n.messages.forEach(function(e){return i(e)});var o={state:Object.assign({},t.state,n),world:t.world};return o}Object.defineProperty(t,"__esModule",{value:!0});var v=n(2),h=r(v),y=n(3),p=r(y),m=n(22),M=r(m),_=n(23),O=r(_),g=n(30),T=r(g),E=n(7),b=r(E),S=n(31),x=r(S),P=n(32),A=r(P),j=n(34),w=r(j),H=n(35),k=r(H),V=n(36),R=r(V),U=n(37),I=r(U);t["default"]={init:a}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=Object.freeze({MOVE_EAST:"MOVE_EAST",MOVE_NORTH:"MOVE_NORTH",MOVE_NORTHEAST:"MOVE_NORTHEAST",MOVE_NORTHWEST:"MOVE_NORTHWEST",MOVE_SOUTH:"MOVE_SOUTH",MOVE_SOUTHEAST:"MOVE_SOUTHEAST",MOVE_SOUTHWEST:"MOVE_SOUTHWEST",MOVE_WEST:"MOVE_WEST"})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function u(e){return Boolean(e)?this.energy.current>=c(e):!1}function a(e){return _["default"].create(W,[s["default"].create("@","#f8f8f8",100),y["default"].create(v["default"].create(1)),m["default"].create(6e3),g["default"].create(100),E["default"].create("CARL"),S["default"].create(),P["default"].create(i),j["default"].create(u),H["default"].create("Carl"),V["default"].create(e.x,e.y),N["default"].create(f)])}function i(e){return m["default"].drain(this,c(e))}function o(e){return e.find(function(e){return"CARL"===e.id})}function c(e){return U["default"].isLand(e)?10:100}function f(e){return m["default"].fill(this,e.energy.current)}Object.defineProperty(t,"__esModule",{value:!0});var l=n(4),s=r(l),d=n(5),v=r(d),h=n(10),y=r(h),p=n(11),m=r(p),M=n(7),_=r(M),O=n(12),g=r(O),T=n(13),E=r(T),b=n(14),S=r(b),x=n(15),P=r(x),A=n(16),j=r(A),w=n(8),H=r(w),k=n(17),V=r(k),R=n(19),U=r(R),I=n(21),N=r(I),W="Carl";t["default"]={create:a,findIn:o,type:W}},function(e,t){"use strict";function n(e){var t=arguments.length<=1||void 0===arguments[1]?"#ccc":arguments[1],n=arguments.length<=2||void 0===arguments[2]?0:arguments[2];return{key:"avatar",value:{character:e,importance:n,style:t}}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={create:n}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function u(e){return s["default"].create(p,[o["default"].create("#","#CC6"),f["default"].create(e),v["default"].create("CPU")])}function a(){return u(y["default"]["float"](1,6).toFixed(1))}Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),o=r(i),c=n(6),f=r(c),l=n(7),s=r(l),d=n(8),v=r(d),h=n(9),y=r(h),p="CPU";t["default"]={create:u,generate:a,type:p}},function(e,t){"use strict";function n(e){return{key:"clockSpeed",value:e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={create:n}},function(e,t){"use strict";function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){return e.hasOwnProperty(t.key)?(console.error("The "+e.type+' entity already has a "'+t.key+'" property.'),e):Object.assign({},e,n({},t.key,t.value))}function u(e){var t=arguments.length<=1||void 0===arguments[1]?[]:arguments[1];return t.reduce(function(e,t){var r=t.key,u=t.value;return Object.assign({},e,n({},r,u))},{type:e})}function a(e,t){return e.hasOwnProperty(t)?Object.keys(e).filter(function(e){return e!==t}).reduce(function(t,r){return Object.assign({},t,n({},r,e[r]))},{}):(console.error("The "+e.type+' entity does not have a "'+t+'" property.'),e)}function i(e,t){return e.type===t.type}function o(e,t){var r=Object.keys(t).reduce(function(t,n){return e.hasOwnProperty(n)?t&&!0:(console.error("The "+e.type+' entity does not have a "'+n+'" property.'),!1)},!0);return r?Object.assign({},e,Object.keys(t).reduce(function(r,u){return Object.assign({},r,n({},u,t[u](e[u])))},{})):e}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={attach:r,create:u,detach:a,is:i,update:o}},function(e,t){"use strict";function n(e){return{key:"name",value:e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={create:n}},function(e,t){"use strict";function n(){return u(["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"])}function r(){var e=arguments.length<=0||void 0===arguments[0]?0:arguments[0],t=arguments.length<=1||void 0===arguments[1]?Number.MAX_VALUE:arguments[1];return Math.random()*(t-e)+e}function u(e){return Array.isArray(e)?e[a(0,e.length-1)]:e[u(Object.keys(e))]}function a(){var e=arguments.length<=0||void 0===arguments[0]?0:arguments[0],t=arguments.length<=1||void 0===arguments[1]?Number.MAX_VALUE:arguments[1];return Math.floor(Math.random()*(t-e+i)+e)}Object.defineProperty(t,"__esModule",{value:!0});var i=1-1e-16;t["default"]={character:n,"float":r,from:u,integer:a}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function u(){var e=arguments.length<=0||void 0===arguments[0]?null:arguments[0];return{key:"cpuSlot",value:{cpu:e}}}function a(e){return f["default"].update(e,{cpuSlot:function(){return{cpu:null}}})}function i(e,t){return f["default"].update(e,{cpuSlot:function(){return{cpu:t}}})}function o(e){return null===e.cpuSlot.cpu}Object.defineProperty(t,"__esModule",{value:!0});var c=n(7),f=r(c);t["default"]={create:u,empty:a,insert:i,isEmpty:o}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function u(e){return{key:"energy",value:{current:e,max:e}}}function a(e,t){return l["default"].update(e,{energy:function(e){return{current:Math.max(0,e.current-t),max:e.max}}})}function i(e,t){return l["default"].update(e,{energy:function(e){return{current:Math.min(e.max,e.current+t),max:e.max}}})}function o(e){return e.energy.current<=0}function c(e){return e.energy.current>=0}Object.defineProperty(t,"__esModule",{value:!0});var f=n(7),l=r(f);t["default"]={create:u,drain:a,fill:i,isDrained:o,isFull:c}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function u(e){return{key:"health",value:{current:e,max:e}}}function a(e,t){return l["default"].update(e,{health:function(e){return{current:Math.min(e.max,e.current+t),max:e.max}}})}function i(e,t){return l["default"].update(e,{health:function(e){return{current:Math.max(0,e.current-t),max:e.max}}})}function o(e){return e.health>0}function c(e){return!o(e)}Object.defineProperty(t,"__esModule",{value:!0});var f=n(7),l=r(f);t["default"]={create:u,heal:a,hit:i,isAlive:o,isDead:c}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function u(e){return{key:"id",value:e}}function a(){return u(""+Date.now()+o["default"].integer(0,999))}Object.defineProperty(t,"__esModule",{value:!0});var i=n(9),o=r(i);t["default"]={create:u,generate:a}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function u(e,t){return l["default"].update(e,{inventory:function(e){return e.concat(t)}})}function a(){var e=arguments.length<=0||void 0===arguments[0]?[]:arguments[0];return{key:"inventory",value:e}}function i(e){return l["default"].update(e,{inventory:function(){return[]}})}function o(e){return 0===e.inventory.length}function c(e,t){return l["default"].update(e,{inventory:function(e){return e.filter(function(e){return e!==t})}})}Object.defineProperty(t,"__esModule",{value:!0});var f=n(7),l=r(f);t["default"]={addItem:u,create:a,empty:i,isEmpty:o,removeItem:c}},function(e,t){"use strict";function n(e){return{key:"moveAction",value:e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={create:n}},function(e,t){"use strict";function n(e){return{key:"moveRestriction",value:e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={create:n}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function u(e,t){return{key:"position",value:{x:e,y:t}}}function a(e,t){var n=s["default"][t];return{x:e.x+n.x,y:e.y+n.y}}function i(e,t){return e.x===t.x&&e.y===t.y}function o(e,t){var n=t.x,r=t.y;return f["default"].update(e,{position:function(){return{x:n,y:r}}})}Object.defineProperty(t,"__esModule",{value:!0});var c=n(7),f=r(c),l=n(18),s=r(l);t["default"]={create:u,from:a,match:i,set:o}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=Object.freeze({EAST:{x:1,y:0},NORTH:{x:0,y:-1},NORTHEAST:{x:1,y:-1},NORTHWEST:{x:-1,y:-1},SOUTH:{x:0,y:1},SOUTHEAST:{x:1,y:1},SOUTHWEST:{x:-1,y:1},WEST:{x:-1,y:0}})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function u(e){var t=e>0;return{backgroundColor:t?s:v,avatar:t?l:d,elevation:e}}function a(e){return e.elevation>0}Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),o=r(i),c=n(20),f=r(c),l=o["default"].create(".","#462").value,s=f["default"].create("#240").value,d=o["default"].create("~","#68A").value,v=f["default"].create("#246").value;t["default"]={create:u,isLand:a}},function(e,t){"use strict";function n(e){return{key:"backgroundColor",value:e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={create:n}},function(e,t){"use strict";function n(e){return{key:"suckle",value:e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={create:n}},function(e,t){"use strict";function n(e){var t=arguments.length<=1||void 0===arguments[1]?document:arguments[1];return t.querySelector(e)}function r(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=arguments.length<=2||void 0===arguments[2]?[]:arguments[2];("object"!==("undefined"==typeof t?"undefined":a(t))||Array.isArray(t))&&(n=t,t={}),Array.isArray(n)||(n=[n]);var r=document.createElement(e);return Object.keys(t).forEach(function(e){r.setAttribute(e,t[e])}),n.map(function(e){return"number"==typeof e||"string"==typeof e?u(e):e}).forEach(function(e){return r.appendChild(e)}),r}function u(e){return document.createTextNode(e)}Object.defineProperty(t,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};t["default"]={find:n,html:r,text:u}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function u(e,t){for(var n=new l["default"]({frequency:.03,max:10,min:-10,octaves:8}),r=new Array(e),u=0;e>u;u++){r[u]=new Array(t);for(var a=0;t>a;a++)r[u][a]=p["default"].create(n.in2D(u,a))}return{height:t,tiles:r,width:e}}function a(e){var t=arguments.length<=1||void 0===arguments[1]?5e3:arguments[1],n=[{type:d["default"],weight:3},{type:c["default"],weight:1}],r=void 0,u=[],a=void 0,i=[];n.forEach(function(e){for(var t=0;t<e.weight;t++)i=[].concat.call(i,e.type)});for(var o=0;t>o;o++)switch(r=M["default"].randomLandPosition(e),a=h["default"].from(i)){case d["default"]:u=u.concat(d["default"].create(r));break;case c["default"]:u=u.concat(c["default"].generate(r))}return u}function i(e){return M["default"].randomLandPosition(e)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(24),c=r(o),f=n(25),l=r(f),s=n(26),d=r(s),v=n(9),h=r(v),y=n(19),p=r(y),m=n(29),M=r(m);t["default"]={generate:u,populate:a,startingPosition:i}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function u(e){var t=arguments.length<=1||void 0===arguments[1]?null:arguments[1],n=[o["default"].create("%","#E6E69C"),f["default"].create(e),v["default"].create("battery")];return t&&n.push(y["default"].create(t.x,t.y)),s["default"].create(M,n)}function a(){var e=arguments.length<=0||void 0===arguments[0]?null:arguments[0];return u(m["default"].integer(600,1800),e)}Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),o=r(i),c=n(11),f=r(c),l=n(7),s=r(l),d=n(8),v=r(d),h=n(17),y=r(h),p=n(9),m=r(p),M="Battery";t["default"]={create:u,generate:a,type:M}},function(e,t){function n(e){if(e||(e={}),this.amplitude=e.amplitude||1,this.frequency=e.frequency||1,this.octaves=parseInt(e.octaves||1),this.persistence=e.persistence||.5,this.random=e.random||Math.random,"number"==typeof e.min&&"number"==typeof e.max)if(e.min>=e.max)console.error("options.min must be less than options.max");else{var t=parseFloat(e.min),n=parseFloat(e.max),r=n-t;this.scale=function(e){return t+(e+1)/2*r}}var u,a=new Uint8Array(256);for(u=0;256>u;u++)a[u]=u;var i,o;for(u=255;u>0;u--)i=Math.floor((u+1)*this.random()),o=a[u],a[u]=a[i],a[i]=o;for(this.perm=new Uint8Array(512),this.permMod12=new Uint8Array(512),u=0;512>u;u++)this.perm[u]=a[255&u],this.permMod12[u]=this.perm[u]%12}function r(e,t,n){return e[0]*t+e[1]*n}function u(e,t,n,r){return e[0]*t+e[1]*n+e[2]*r}function a(e,t,n,r,u){return e[0]*t+e[1]*n+e[2]*r+e[3]*u}var i=(3-Math.sqrt(3))/6,o=1/6,c=(5-Math.sqrt(5))/20,f=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,-1],[0,1,-1],[0,-1,-1]],l=[[0,1,1,1],[0,1,1,-1],[0,1,-1,1],[0,1,-1,-1],[0,-1,1,1],[0,-1,1,-1],[0,-1,-1,1],[0,-1,-1,-1],[1,0,1,1],[1,0,1,-1],[1,0,-1,1],[1,0,-1,-1],[-1,0,1,1],[-1,0,1,-1],[-1,0,-1,1],[-1,0,-1,-1],[1,1,0,1],[1,1,0,-1],[1,-1,0,1],[1,-1,0,-1],[-1,1,0,1],[-1,1,0,-1],[-1,-1,0,1],[-1,-1,0,-1],[1,1,1,0],[1,1,-1,0],[1,-1,1,0],[1,-1,-1,0],[-1,1,1,0],[-1,1,-1,0],[-1,-1,1,0],[-1,-1,-1,0]];e.exports=n,n.prototype.cylindrical2D=function(e,t,n){var r=t/e,u=e/(2*Math.PI),a=2*r*Math.PI,i=u*Math.sin(a),o=u*Math.cos(a);return this.in3D(i,o,n)},n.prototype.cylindrical3D=function(e,t,n,r){var u=t/e,a=e/(2*Math.PI),i=2*u*Math.PI,o=a*Math.sin(i),c=a*Math.cos(i);return this.in4D(o,c,n,r)},n.prototype.in2D=function(e,t){for(var n=this.amplitude,r=this.frequency,u=0,a=0,i=this.persistence,o=0;o<this.octaves;o++)a+=this.raw2D(e*r,t*r)*n,u+=n,n*=i,r*=2;var c=a/u;return this.scale?this.scale(c):c},n.prototype.in3D=function(e,t,n){for(var r=this.amplitude,u=this.frequency,a=0,i=0,o=this.persistence,c=0;c<this.octaves;c++)i+=this.raw3D(e*u,t*u,n*u)*r,a+=r,r*=o,u*=2;var f=i/a;return this.scale?this.scale(f):f},n.prototype.in4D=function(e,t,n,r){for(var u=this.amplitude,a=this.frequency,i=0,o=0,c=this.persistence,f=0;f<this.octaves;f++)o+=this.raw4D(e*a,t*a,n*a,r*a)*u,i+=u,u*=c,a*=2;var l=o/i;return this.scale?this.scale(l):l},n.prototype.raw2D=function(e,t){var n,u,a,o,c,l=this.perm,s=this.permMod12,d=.5*(e+t)*(Math.sqrt(3)-1),v=Math.floor(e+d),h=Math.floor(t+d),y=(v+h)*i,p=v-y,m=h-y,M=e-p,_=t-m;M>_?(o=1,c=0):(o=0,c=1);var O=M-o+i,g=_-c+i,T=M-1+2*i,E=_-1+2*i,b=255&v,S=255&h,x=s[b+l[S]],P=s[b+o+l[S+c]],A=s[b+1+l[S+1]],j=.5-M*M-_*_;0>j?n=0:(j*=j,n=j*j*r(f[x],M,_));var w=.5-O*O-g*g;0>w?u=0:(w*=w,u=w*w*r(f[P],O,g));var H=.5-T*T-E*E;return 0>H?a=0:(H*=H,a=H*H*r(f[A],T,E)),70.14805770653952*(n+u+a)},n.prototype.raw3D=function(e,t,n){var r,a,i,c,l,s,d,v,h,y,p=this.perm,m=this.permMod12,M=(e+t+n)/3,_=Math.floor(e+M),O=Math.floor(t+M),g=Math.floor(n+M),T=(_+O+g)*o,E=_-T,b=O-T,S=g-T,x=e-E,P=t-b,A=n-S;x>=P?P>=A?(l=1,s=0,d=0,v=1,h=1,y=0):x>=A?(l=1,s=0,d=0,v=1,h=0,y=1):(l=0,s=0,d=1,v=1,h=0,y=1):A>P?(l=0,s=0,d=1,v=0,h=1,y=1):A>x?(l=0,s=1,d=0,v=0,h=1,y=1):(l=0,s=1,d=0,v=1,h=1,y=0);var j=x-l+o,w=P-s+o,H=A-d+o,k=x-v+2*o,V=P-h+2*o,R=A-y+2*o,U=x-1+3*o,I=P-1+3*o,N=A-1+3*o,W=255&_,L=255&O,C=255&g,D=m[W+p[L+p[C]]],q=m[W+l+p[L+s+p[C+d]]],F=m[W+v+p[L+h+p[C+y]]],z=m[W+1+p[L+1+p[C+1]]],B=.5-x*x-P*P-A*A;0>B?r=0:(B*=B,r=B*B*u(f[D],x,P,A));var X=.5-j*j-w*w-H*H;0>X?a=0:(X*=X,a=X*X*u(f[q],j,w,H));var G=.5-k*k-V*V-R*R;0>G?i=0:(G*=G,i=G*G*u(f[F],k,V,R));var Y=.5-U*U-I*I-N*N;return 0>Y?c=0:(Y*=Y,c=Y*Y*u(f[z],U,I,N)),94.68493150681971*(r+a+i+c)},n.prototype.raw4D=function(e,t,n,r){var u,i,o,f,s,d=this.perm,v=(this.permMod12,(e+t+n+r)*(Math.sqrt(5)-1)/4),h=Math.floor(e+v),y=Math.floor(t+v),p=Math.floor(n+v),m=Math.floor(r+v),M=(h+y+p+m)*c,_=h-M,O=y-M,g=p-M,T=m-M,E=e-_,b=t-O,S=n-g,x=r-T,P=0,A=0,j=0,w=0;E>b?P++:A++,E>S?P++:j++,E>x?P++:w++,b>S?A++:j++,b>x?A++:w++,S>x?j++:w++;var H,k,V,R,U,I,N,W,L,C,D,q;H=P>=3?1:0,k=A>=3?1:0,V=j>=3?1:0,R=w>=3?1:0,U=P>=2?1:0,I=A>=2?1:0,N=j>=2?1:0,W=w>=2?1:0,L=P>=1?1:0,C=A>=1?1:0,D=j>=1?1:0,q=w>=1?1:0;var F=E-H+c,z=b-k+c,B=S-V+c,X=x-R+c,G=E-U+2*c,Y=b-I+2*c,J=S-N+2*c,K=x-W+2*c,Q=E-L+3*c,Z=b-C+3*c,$=S-D+3*c,ee=x-q+3*c,te=E-1+4*c,ne=b-1+4*c,re=S-1+4*c,ue=x-1+4*c,ae=255&h,ie=255&y,oe=255&p,ce=255&m,fe=d[ae+d[ie+d[oe+d[ce]]]]%32,le=d[ae+H+d[ie+k+d[oe+V+d[ce+R]]]]%32,se=d[ae+U+d[ie+I+d[oe+N+d[ce+W]]]]%32,de=d[ae+L+d[ie+C+d[oe+D+d[ce+q]]]]%32,ve=d[ae+1+d[ie+1+d[oe+1+d[ce+1]]]]%32,he=.5-E*E-b*b-S*S-x*x;0>he?u=0:(he*=he,u=he*he*a(l[fe],E,b,S,x));var ye=.5-F*F-z*z-B*B-X*X;0>ye?i=0:(ye*=ye,i=ye*ye*a(l[le],F,z,B,X));var pe=.5-G*G-Y*Y-J*J-K*K;0>pe?o=0:(pe*=pe,o=pe*pe*a(l[se],G,Y,J,K));var me=.5-Q*Q-Z*Z-$*$-ee*ee;0>me?f=0:(me*=me,f=me*me*a(l[de],Q,Z,$,ee));var Me=.5-te*te-ne*ne-re*re-ue*ue;return 0>Me?s=0:(Me*=Me,s=Me*Me*a(l[ve],te,ne,re,ue)),72.37855765153664*(u+i+o+f+s)},n.prototype.spherical2D=function(e,t,n){var r=t/e,u=n/e,a=2*r*Math.PI,i=u*Math.PI,o=Math.sin(i+Math.PI),c=2*Math.PI,f=c*Math.sin(a)*o,l=c*Math.cos(a)*o,s=c*Math.cos(i);return this.in3D(f,l,s)},n.prototype.spherical3D=function(e,t,n,r){var u=t/e,a=n/e,i=2*u*Math.PI,o=a*Math.PI,c=Math.sin(o+Math.PI),f=2*Math.PI,l=f*Math.sin(i)*c,s=f*Math.cos(i)*c,d=f*Math.cos(o);return this.in4D(l,s,d,r)}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function u(e){return c["default"].create(g,[i["default"].create("m","#e86b6b"),l["default"].create(100),d["default"].create([]),h["default"].create(p["default"].HOSTILE),M["default"].create("monster"),O["default"].create(e.x,e.y)])}Object.defineProperty(t,"__esModule",{value:!0});var a=n(4),i=r(a),o=n(7),c=r(o),f=n(12),l=r(f),s=n(14),d=r(s),v=n(27),h=r(v),y=n(28),p=r(y),m=n(8),M=r(m),_=n(17),O=r(_),g="Monster";t["default"]={create:u,type:g}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function u(){var e=arguments.length<=0||void 0===arguments[0]?i["default"].PASSIVE:arguments[0];return{key:"logic",value:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(28),i=r(a);t["default"]={create:u}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=Object.freeze({HOSTILE:"HOSTILE",PASSIVE:"PASSIVE"})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function u(e){var t=l["default"].integer(0,e.width-1),n=l["default"].integer(0,e.height-1),r=e.tiles[t][n];return d["default"].isLand(r)?{x:t,y:n}:u(e)}function a(e,t){var n=t.x,r=t.y;return e.tiles[n][r]}function i(e,t,n){var r=c["default"].from(n,t);return r.x<0||r.x>=e.width||r.y<0||r.y>=e.height?null:a(e,r)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(17),c=r(o),f=n(9),l=r(f),s=n(19),d=r(s);t["default"]={randomLandPosition:u,tileAt:a,tileTo:i}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=Object.freeze({EAST:"EAST",NORTH:"NORTH",NORTHEAST:"NORTHEAST",NORTHWEST:"NORTHWEST",SOUTH:"SOUTH",SOUTHEAST:"SOUTHEAST",SOUTHWEST:"SOUTHWEST",WEST:"WEST"})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function u(e){return{key:"move",value:e}}function a(e){var t=f["default"][e.move],n={x:e.position.x+t.x,y:e.position.y+t.y};return n&&(e=s["default"].set(e,n)),o["default"].detach(e,"move")}Object.defineProperty(t,"__esModule",{value:!0});var i=n(7),o=r(i),c=n(18),f=r(c),l=n(17),s=r(l);t["default"]={create:u,perform:a}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function u(e){var t=[],n=[],r=e.state.entities.map(function(r){if(!r.move||!r.position)return r;var u=M["default"].tileTo(e.world,r.move,r.position);if(null===u)return l["default"].detach(r,h["default"].key);if(r.moveRestriction&&!r.moveRestriction(u))return l["default"].detach(r,h["default"]);if(l["default"].is(r,c["default"])){var a=p["default"].from(r.position,r.move);d["default"].entitiesAt(e,a).filter(function(e){return e.hasOwnProperty("name")}).forEach(function(e){t.push("You encounter a "+e.name+".")})}return r.moveAction&&(r=r.moveAction(u)),r=h["default"].perform(r),r.suckle&&d["default"].entitiesAt(e,r.position).filter(function(e){return l["default"].is(e,i["default"])}).forEach(function(e){r=r.suckle(e),n.push(e)}),r}).filter(function(e){return!n.includes(e)});return Object.assign({},e.state,{entities:r,messages:e.state.messages.concat(t)})}Object.defineProperty(t,"__esModule",{value:!0});var a=n(24),i=r(a),o=n(3),c=r(o),f=n(7),l=r(f),s=n(33),d=r(s),v=n(31),h=r(v),y=n(17),p=r(y),m=n(29),M=r(m);t["default"]={run:u}},function(e,t){"use strict";function n(e,t){return e.state.entities.filter(function(e){return e.hasOwnProperty("position")}).filter(function(e){return e.position.x===t.x&&e.position.y===t.y})}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={entitiesAt:n}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function u(e,t,n){return e.filter(function(e){if(!e.avatar||!e.position)return!1;var r=e.position;return r.x>=t.x&&r.x<=n.x&&r.y>=t.y&&r.y<=n.y})}function a(e){var t=e.state,n=e.world,r=f["default"].find("#Field"),a=r.getContext("2d");a.clearRect(0,0,r.width,r.height),a.font="20px monospace";for(var i=o["default"].findIn(t.entities),c=i.position,l=r.width%20,d=r.height%20,v=l>0?l-20:0,h=d>0?d-20:0,y=Math.ceil(r.width/20),p=Math.ceil(r.height/20),m=Math.ceil((y-1)/2),M=Math.ceil((p-1)/2),_={x:c.x-m,y:c.y-M},O={x:_.x+y-1,y:_.y+p-1},g=u(t.entities,_,O),T=void 0,E=void 0,b=void 0,S=void 0,x=void 0,P=void 0,A=void 0,j=void 0,w=0;y>w;w++)for(var H=0;p>H;H++)A=c.x+w-m,j=c.y+H-M,E=20*w+v,b=20*H+h,0>A||A>=n.width||0>j||j>=n.height||(x=s["default"].tileAt(n,{x:A,y:j}),a.fillStyle=x.backgroundColor,a.fillRect(E,b,20,20),S=g.filter(function(e){return e.position.x===A&&e.position.y===j}),P=S.length>0?S.reduce(function(e,t){return t.avatar.importance>e.avatar.importance?t:e}):null,T=P?P.avatar:x.avatar,a.fillStyle=T.style,a.fillText(T.character,E+4,b+16))}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=a;var i=n(3),o=r(i),c=n(22),f=r(c),l=n(29),s=r(l)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function u(e){var t=e.state,n=i["default"].findIn(t.entities).inventory.map(function(e){return c["default"].html("p",e.name)}),r=c["default"].html("div",{id:"Inventory"},n);document.body.replaceChild(r,c["default"].find("#Inventory"))}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=u;var a=n(3),i=r(a),o=n(22),c=r(o)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function u(e){var t=e.state.messages,n=i["default"].html("div",{id:"Message"},[t.length>0?t[t.length-1]:i["default"].html("p",{})]);document.body.replaceChild(n,i["default"].find("#Message"))}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=u;var a=n(22),i=r(a)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function u(e){var t=e.state,n=i["default"].findIn(t.entities),r=c["default"].html("span",{"class":"energy"});r.style.width=100*n.energy.current/n.energy.max+"%";var u=c["default"].html("div",{id:"Status"},[c["default"].html("span",{"class":"stats"},[n.health.current+"/"+n.health.max+"HP",c["default"].html("span",{"class":"cpu"},["CPU:"]),n.cpuSlot.cpu.clockSpeed.toFixed(1)+"GHz"]),c["default"].html("span",{"class":"energy-bar"},[r])]);document.body.replaceChild(u,c["default"].find("#Status"))}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=u;var a=n(3),i=r(a),o=n(22),c=r(o)}]);