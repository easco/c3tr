!function(t){function e(n){if(r[n])return r[n].exports;var a=r[n]={exports:{},id:n,loaded:!1};return t[n].call(a.exports,a,a.exports,e),a.loaded=!0,a.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){"use strict";var n=r(1);window.addEventListener("load",n.init)},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){var r=[{type:b["default"],weight:3},{type:h["default"],weight:1}],n=void 0,a=[],u=void 0,i=[];r.forEach(function(t){for(var e=0;e<t.weight;e++)i=[].concat.call(i,t.type)});for(var o=0;e>o;o++)switch(n=c(t),u=R["default"].from(i)){case b["default"]:a=a.concat(b["default"].create(n));break;case h["default"]:a=a.concat(h["default"].generate(n))}return a}function u(){var t=768,e=1024,r=C["default"].generate(e,t),n=c(r);return{state:{entities:a(r,5e3).concat(m["default"].create(n)),messages:[],worldHeight:t,worldWidth:e},world:r}}function i(){var t=u();f(window.innerWidth,window.innerHeight),s(t),window.addEventListener("keydown",function(e){var r=void 0;switch(e.keyCode){case 77:case 81:return l();case 39:case 76:r=z.MOVE_EAST;break;case 38:case 75:r=z.MOVE_NORTH;break;case 85:r=z.MOVE_NORTHEAST;break;case 89:r=z.MOVE_NORTHWEST;break;case 40:case 74:r=z.MOVE_SOUTH;break;case 78:r=z.MOVE_SOUTHEAST;break;case 66:r=z.MOVE_SOUTHWEST;break;case 37:case 72:r=z.MOVE_WEST}Boolean(r)&&(t=d(r,t),s(t))}),window.addEventListener("resize",function(){f(window.innerWidth,window.innerHeight),s(t)})}function o(t){var e=(0,F.find)("#Log"),r=(0,F.html)("p",{},[t]);e.insertBefore(r,e.firstChild)}function c(t){for(var e=void 0,r=void 0,n=void 0;;)if(r=R["default"].integer(0,t.width-1),n=R["default"].integer(0,t.height-1),e=t.tiles[r][n],P["default"].isLand(e))return{x:r,y:n}}function s(t){(0,j["default"])(t),(0,I["default"])(t),(0,q["default"])(t)}function f(t,e){var r=(0,F.find)("#Field");r.setAttribute("width",t),r.setAttribute("height",e-80)}function l(){var t=(0,F.find)("#Log");t.classList.contains("open")?t.classList.remove("open"):t.classList.add("open")}function d(t,e){var r=e.state,n=r.entities,a=m["default"].find(r.entities),u=void 0;switch(t){case z.MOVE_EAST:u=M["default"].EAST;break;case z.MOVE_NORTH:u=M["default"].NORTH;break;case z.MOVE_NORTHEAST:u=M["default"].NORTHEAST;break;case z.MOVE_NORTHWEST:u=M["default"].NORTHWEST;break;case z.MOVE_SOUTH:u=M["default"].SOUTH;break;case z.MOVE_SOUTHEAST:u=M["default"].SOUTHEAST;break;case z.MOVE_SOUTHWEST:u=M["default"].SOUTHWEST;break;case z.MOVE_WEST:u=M["default"].WEST}u&&(a=T["default"].attach(a,H["default"].create(u)),n=T["default"].listReplace(n,m["default"].findFn,a)),r=Object.assign({},e.state,{entities:n,messages:[]}),r=S["default"].run(Object.assign({},e,{state:r})),r=N["default"].run(Object.assign({},e,{state:r})),r=O["default"].run(Object.assign({},e,{state:r})),r.messages.forEach(function(t){return o(t)});var i={state:Object.assign({},e.state,r),world:e.world};return i}var p=r(2),h=n(p),v=r(11),m=n(v),y=r(23),O=n(y),g=r(24),M=n(g),E=r(5),T=n(E),x=r(25),S=n(x),_=r(26),b=n(_),w=r(30),H=n(w),A=r(31),N=n(A),V=r(10),R=n(V),U=r(20),P=n(U),W=r(28),C=n(W),k=r(33),I=n(k),L=r(35),j=n(L),D=r(36),q=n(D),F=r(34),z=Object.freeze({MOVE_EAST:"MOVE_EAST",MOVE_NORTH:"MOVE_NORTH",MOVE_NORTHEAST:"MOVE_NORTHEAST",MOVE_NORTHWEST:"MOVE_NORTHWEST",MOVE_SOUTH:"MOVE_SOUTH",MOVE_SOUTHEAST:"MOVE_SOUTHEAST",MOVE_SOUTHWEST:"MOVE_SOUTHWEST",MOVE_WEST:"MOVE_WEST"});t.exports={init:i}},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1],r=[o["default"].create("%","#E6E69C"),s["default"].create(t),p["default"].create("battery")];return e&&r.push(v["default"].create(e.x,e.y)),l["default"].create(r)}function u(){var t=arguments.length<=0||void 0===arguments[0]?null:arguments[0];return a(y["default"].integer(600,1800),t)}var i=r(3),o=n(i),c=r(4),s=n(c),f=r(5),l=n(f),d=r(7),p=n(d),h=r(8),v=n(h),m=r(10),y=n(m),O="BATTERY";t.exports={create:a,generate:u,type:O}},function(t,e){"use strict";function r(t){var e=arguments.length<=1||void 0===arguments[1]?"#ccc":arguments[1],r=arguments.length<=2||void 0===arguments[2]?0:arguments[2];return{type:n,value:{character:t,importance:r,style:e}}}var n="AVATAR";t.exports={create:r,type:n}},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t){return{type:s,value:{current:t,max:t}}}function u(t,e){return c["default"].update(t,s,function(t){return{current:Math.max(0,t.current-e),max:t.max}})}function i(t,e){return c["default"].update(t,s,function(t){return{current:Math.min(t.max,t.current+e),max:t.max}})}var o=r(5),c=n(o),s="ENERGY";t.exports={create:a,drain:u,fill:i,type:s}},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function u(){var t=arguments.length<=0||void 0===arguments[0]?[]:arguments[0];return t.reduce(function(t,e){return Object.assign({},t,a({},p["default"].propName(e.type),e.value))},{})}function i(t,e){var r=p["default"].propName(e.type);return t.hasOwnProperty(r)?(console.error("The entity already has a "+r+" property."),t):Object.assign({},t,a({},r,e.value))}function o(t,e){var r=p["default"].propName(e);return Object.keys(t).filter(function(t){return t!==r}).reduce(function(e,r){return Object.assign({},e,a({},r,t[r]))},{})}function c(t,e){return t[p["default"].propName(e)]}function s(t,e){return t.hasOwnProperty(p["default"].propName(e))}function f(t,e,r){return t.map(function(t){return e(t)?r:t})}function l(t,e,r){var n=p["default"].propName(e);return Object.keys(t).reduce(function(e,u){return Object.assign({},e,a({},u,u===n?r(t[u]):t[u]))},{})}var d=r(6),p=n(d);t.exports={attach:i,create:u,detach:o,get:c,has:s,listReplace:f,update:l}},function(t,e){"use strict";function r(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function n(t){return t.toLowerCase().replace(/_([a-z])/g,function(t,e){return e.toUpperCase()})}t.exports={number:r,propName:n}},function(t,e){"use strict";function r(t){return{type:n,value:t}}var n="NAME";t.exports={create:r,type:n}},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){return{type:d,value:{x:t,y:e}}}function u(t,e){var r=l["default"][e];return{x:t.x+r.x,y:t.y+r.y}}function i(t,e){return t.x===e.x&&t.y===e.y}function o(t,e){var r=e.x,n=e.y;return s["default"].update(t,d,function(){return{x:r,y:n}})}var c=r(5),s=n(c),f=r(9),l=n(f),d="POSITION";t.exports={create:a,from:u,match:i,move:o,type:d}},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=Object.freeze({EAST:{x:1,y:0},NORTH:{x:0,y:-1},NORTHEAST:{x:1,y:-1},NORTHWEST:{x:-1,y:-1},SOUTH:{x:0,y:1},SOUTHEAST:{x:1,y:1},SOUTHWEST:{x:-1,y:1},WEST:{x:-1,y:0}})},function(t,e){"use strict";function r(){return a(["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"])}function n(){var t=arguments.length<=0||void 0===arguments[0]?0:arguments[0],e=arguments.length<=1||void 0===arguments[1]?Number.MAX_VALUE:arguments[1];return Math.random()*(e-t)+t}function a(t){return Array.isArray(t)?t[u(0,t.length-1)]:t[a(Object.keys(t))]}function u(){var t=arguments.length<=0||void 0===arguments[0]?0:arguments[0],e=arguments.length<=1||void 0===arguments[1]?Number.MAX_VALUE:arguments[1];return Math.floor(Math.random()*(e-t+i)+t)}var i=1-1e-16;t.exports={character:r,"float":n,from:a,integer:u}},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){return Boolean(e)?t.energy.current>=s(e):!1}function u(t){return M["default"].create([d["default"].create("@","#f8f8f8",100),m["default"].create(h["default"].create(1)),O["default"].create(6e3),T["default"].create(100),S["default"].create("CARL"),b["default"].create([]),H["default"].create(c),N["default"].create(a),R["default"].create("Carl"),P["default"].create(t.x,t.y),I["default"].create(f)])}function i(t){return t.find(o)}function o(t){return"CARL"===t.id}function c(t,e){return O["default"].drain(t,s(e))}function s(t){return C["default"].isLand(t)?10:100}function f(t,e){return O["default"].fill(t,e.energy.current)}var l=r(3),d=n(l),p=r(12),h=n(p),v=r(14),m=n(v),y=r(4),O=n(y),g=r(5),M=n(g),E=r(15),T=n(E),x=r(16),S=n(x),_=r(17),b=n(_),w=r(18),H=n(w),A=r(19),N=n(A),V=r(7),R=n(V),U=r(8),P=n(U),W=r(20),C=n(W),k=r(22),I=n(k);t.exports={create:u,find:i,findFn:o}},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t){return l["default"].create([o["default"].create("#","#CC6"),s["default"].create(t),p["default"].create("CPU")])}function u(){return a(v["default"]["float"](1,6).toFixed(1))}var i=r(3),o=n(i),c=r(13),s=n(c),f=r(5),l=n(f),d=r(7),p=n(d),h=r(10),v=n(h);t.exports={create:a,generate:u}},function(t,e){"use strict";function r(t){return{type:n,value:t}}var n="CLOCK_SPEED";t.exports={create:r,type:n}},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(){var t=arguments.length<=0||void 0===arguments[0]?null:arguments[0];return{type:f,value:{cpu:t}}}function u(t){return s["default"].update(t,f,function(){return{cpu:null}})}function i(t,e){return s["default"].update(t,f,function(){return{cpu:e}})}function o(t){return null===s["default"].get(t,f).cpu}var c=r(5),s=n(c),f="CPU_SLOT";t.exports={create:a,empty:u,insert:i,isEmpty:o,type:f}},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t){return{type:f,value:{current:t,max:t}}}function u(t,e){return s["default"].update(t,f,function(t){return{current:Math.min(t.max,t.current+e)}})}function i(t,e){return s["default"].update(t,f,function(t){return{current:Math.max(0,t.current-e)}})}function o(t){return s["default"].get(t,f)>0}var c=r(5),s=n(c),f="HEALTH";t.exports={create:a,heal:u,hit:i,isAlive:o,type:f}},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t){return{type:l,value:t}}function u(t,e){return t.find(function(t){return c["default"].get(t,l)===e})}function i(){return a(""+Date.now()+f["default"].integer(0,999))}var o=r(5),c=n(o),s=r(10),f=n(s),l="ID";t.exports={create:a,find:u,generate:i,type:l}},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){return f["default"].update(t,l,function(t){return t.concat(e)})}function u(){var t=arguments.length<=0||void 0===arguments[0]?[]:arguments[0];return{type:l,value:t}}function i(t){return f["default"].update(t,l,function(){return[]})}function o(t){return 0===f["default"].get(t,l).length}function c(t,e){return f["default"].update(t,l,function(t){return t.filter(function(t){return t!==e})})}var s=r(5),f=n(s),l="INVENTORY";t.exports={add:a,create:u,empty:i,isEmpty:o,remove:c,type:l}},function(t,e){"use strict";function r(t){return{type:n,value:t}}var n="MOVE_EVENT";t.exports={create:r,type:n}},function(t,e){"use strict";function r(t){return{type:n,value:t}}var n="MOVE_RESTRICTION";t.exports={create:r,type:n}},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t){var e=t>0;return{backgroundColor:e?d:h,avatar:e?l:p,elevation:t}}function u(t){return t.elevation>0}var i=r(3),o=n(i),c=r(21),s=n(c),f=r(5),l=(n(f),o["default"].create(".","#462").value),d=s["default"].create("#240").value,p=o["default"].create("~","#68A").value,h=s["default"].create("#246").value;t.exports={create:a,isLand:u}},function(t,e){"use strict";function r(t){return{type:n,value:t}}var n="BACKGROUND_COLOR";t.exports={create:r,type:n}},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t){return{type:i,value:t}}var u=r(5),i=(n(u),"SUCKLE");t.exports={create:a,type:i}},function(t,e){"use strict";function r(t){return t.state}t.exports={run:r}},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=Object.freeze({EAST:"EAST",NORTH:"NORTH",NORTHEAST:"NORTHEAST",NORTHWEST:"NORTHWEST",SOUTH:"SOUTH",SOUTHEAST:"SOUTHEAST",SOUTHWEST:"SOUTHWEST",WEST:"WEST"})},function(t,e){"use strict";function r(t){return t.state}t.exports={run:r}},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t){return s["default"].create([i["default"].create("m","#e86b6b"),l["default"].create(100),p["default"].create([]),v["default"].create(v["default"].Mode.HOSTILE),y["default"].create("monster"),g["default"].create(t.x,t.y)])}var u=r(3),i=n(u),o=r(4),c=(n(o),r(5)),s=n(c),f=r(15),l=n(f),d=r(17),p=n(d),h=r(27),v=n(h),m=r(7),y=n(m),O=r(8),g=n(O),M=r(28);n(M);t.exports={create:a}},function(t,e){"use strict";function r(t){return{type:n,value:{action:null,mode:t}}}var n="LOGIC",a=Object.freeze({HOSTILE:"HOSTILE",PASSIVE:"PASSIVE"});t.exports={Mode:a,create:r,type:n}},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){for(var r=new s["default"]({frequency:.03,max:10,min:-10,octaves:8}),n=Date.now(),a=new Array(t),u=0;t>u;u++){a[u]=new Array(e);for(var i=0;e>i;i++)a[u][i]=h["default"].create(r.in2D(u,i))}return console.log("World generation took",Date.now()-n,"ms"),{height:e,tiles:a,width:t}}function u(t,e){var r=e.x,n=e.y;return t.tiles[r][n]}function i(t,e,r){var n=l["default"].from(r,e);return n.x<0||n.x>=t.width||n.y<0||n.y>=t.height?null:u(t,n)}var o=r(5),c=(n(o),r(29)),s=n(c),f=r(8),l=n(f),d=r(10),p=(n(d),r(20)),h=n(p);t.exports={generate:a,tileAt:u,tileTo:i}},function(t,e){function r(t){if(t||(t={}),this.amplitude=t.amplitude||1,this.frequency=t.frequency||1,this.octaves=parseInt(t.octaves||1),this.persistence=t.persistence||.5,this.random=t.random||Math.random,"number"==typeof t.min&&"number"==typeof t.max)if(t.min>=t.max)console.error("options.min must be less than options.max");else{var e=parseFloat(t.min),r=parseFloat(t.max),n=r-e;this.scale=function(t){return e+(t+1)/2*n}}var a,u=new Uint8Array(256);for(a=0;256>a;a++)u[a]=a;var i,o;for(a=255;a>0;a--)i=Math.floor((a+1)*this.random()),o=u[a],u[a]=u[i],u[i]=o;for(this.perm=new Uint8Array(512),this.permMod12=new Uint8Array(512),a=0;512>a;a++)this.perm[a]=u[255&a],this.permMod12[a]=this.perm[a]%12}function n(t,e,r){return t[0]*e+t[1]*r}function a(t,e,r,n){return t[0]*e+t[1]*r+t[2]*n}function u(t,e,r,n,a){return t[0]*e+t[1]*r+t[2]*n+t[3]*a}var i=(3-Math.sqrt(3))/6,o=1/6,c=(5-Math.sqrt(5))/20,s=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,-1],[0,1,-1],[0,-1,-1]],f=[[0,1,1,1],[0,1,1,-1],[0,1,-1,1],[0,1,-1,-1],[0,-1,1,1],[0,-1,1,-1],[0,-1,-1,1],[0,-1,-1,-1],[1,0,1,1],[1,0,1,-1],[1,0,-1,1],[1,0,-1,-1],[-1,0,1,1],[-1,0,1,-1],[-1,0,-1,1],[-1,0,-1,-1],[1,1,0,1],[1,1,0,-1],[1,-1,0,1],[1,-1,0,-1],[-1,1,0,1],[-1,1,0,-1],[-1,-1,0,1],[-1,-1,0,-1],[1,1,1,0],[1,1,-1,0],[1,-1,1,0],[1,-1,-1,0],[-1,1,1,0],[-1,1,-1,0],[-1,-1,1,0],[-1,-1,-1,0]];t.exports=r,r.prototype.cylindrical2D=function(t,e,r){var n=e/t,a=t/(2*Math.PI),u=2*n*Math.PI,i=a*Math.sin(u),o=a*Math.cos(u);return this.in3D(i,o,r)},r.prototype.cylindrical3D=function(t,e,r,n){var a=e/t,u=t/(2*Math.PI),i=2*a*Math.PI,o=u*Math.sin(i),c=u*Math.cos(i);return this.in4D(o,c,r,n)},r.prototype.in2D=function(t,e){for(var r=this.amplitude,n=this.frequency,a=0,u=0,i=this.persistence,o=0;o<this.octaves;o++)u+=this.raw2D(t*n,e*n)*r,a+=r,r*=i,n*=2;var c=u/a;return this.scale?this.scale(c):c},r.prototype.in3D=function(t,e,r){for(var n=this.amplitude,a=this.frequency,u=0,i=0,o=this.persistence,c=0;c<this.octaves;c++)i+=this.raw3D(t*a,e*a,r*a)*n,u+=n,n*=o,a*=2;var s=i/u;return this.scale?this.scale(s):s},r.prototype.in4D=function(t,e,r,n){for(var a=this.amplitude,u=this.frequency,i=0,o=0,c=this.persistence,s=0;s<this.octaves;s++)o+=this.raw4D(t*u,e*u,r*u,n*u)*a,i+=a,a*=c,u*=2;var f=o/i;return this.scale?this.scale(f):f},r.prototype.raw2D=function(t,e){var r,a,u,o,c,f=this.perm,l=this.permMod12,d=.5*(t+e)*(Math.sqrt(3)-1),p=Math.floor(t+d),h=Math.floor(e+d),v=(p+h)*i,m=p-v,y=h-v,O=t-m,g=e-y;O>g?(o=1,c=0):(o=0,c=1);var M=O-o+i,E=g-c+i,T=O-1+2*i,x=g-1+2*i,S=255&p,_=255&h,b=l[S+f[_]],w=l[S+o+f[_+c]],H=l[S+1+f[_+1]],A=.5-O*O-g*g;0>A?r=0:(A*=A,r=A*A*n(s[b],O,g));var N=.5-M*M-E*E;0>N?a=0:(N*=N,a=N*N*n(s[w],M,E));var V=.5-T*T-x*x;return 0>V?u=0:(V*=V,u=V*V*n(s[H],T,x)),70.14805770653952*(r+a+u)},r.prototype.raw3D=function(t,e,r){var n,u,i,c,f,l,d,p,h,v,m=this.perm,y=this.permMod12,O=(t+e+r)/3,g=Math.floor(t+O),M=Math.floor(e+O),E=Math.floor(r+O),T=(g+M+E)*o,x=g-T,S=M-T,_=E-T,b=t-x,w=e-S,H=r-_;b>=w?w>=H?(f=1,l=0,d=0,p=1,h=1,v=0):b>=H?(f=1,l=0,d=0,p=1,h=0,v=1):(f=0,l=0,d=1,p=1,h=0,v=1):H>w?(f=0,l=0,d=1,p=0,h=1,v=1):H>b?(f=0,l=1,d=0,p=0,h=1,v=1):(f=0,l=1,d=0,p=1,h=1,v=0);var A=b-f+o,N=w-l+o,V=H-d+o,R=b-p+2*o,U=w-h+2*o,P=H-v+2*o,W=b-1+3*o,C=w-1+3*o,k=H-1+3*o,I=255&g,L=255&M,j=255&E,D=y[I+m[L+m[j]]],q=y[I+f+m[L+l+m[j+d]]],F=y[I+p+m[L+h+m[j+v]]],z=y[I+1+m[L+1+m[j+1]]],B=.5-b*b-w*w-H*H;0>B?n=0:(B*=B,n=B*B*a(s[D],b,w,H));var G=.5-A*A-N*N-V*V;0>G?u=0:(G*=G,u=G*G*a(s[q],A,N,V));var Y=.5-R*R-U*U-P*P;0>Y?i=0:(Y*=Y,i=Y*Y*a(s[F],R,U,P));var K=.5-W*W-C*C-k*k;return 0>K?c=0:(K*=K,c=K*K*a(s[z],W,C,k)),94.68493150681971*(n+u+i+c)},r.prototype.raw4D=function(t,e,r,n){var a,i,o,s,l,d=this.perm,p=(this.permMod12,(t+e+r+n)*(Math.sqrt(5)-1)/4),h=Math.floor(t+p),v=Math.floor(e+p),m=Math.floor(r+p),y=Math.floor(n+p),O=(h+v+m+y)*c,g=h-O,M=v-O,E=m-O,T=y-O,x=t-g,S=e-M,_=r-E,b=n-T,w=0,H=0,A=0,N=0;x>S?w++:H++,x>_?w++:A++,x>b?w++:N++,S>_?H++:A++,S>b?H++:N++,_>b?A++:N++;var V,R,U,P,W,C,k,I,L,j,D,q;V=w>=3?1:0,R=H>=3?1:0,U=A>=3?1:0,P=N>=3?1:0,W=w>=2?1:0,C=H>=2?1:0,k=A>=2?1:0,I=N>=2?1:0,L=w>=1?1:0,j=H>=1?1:0,D=A>=1?1:0,q=N>=1?1:0;var F=x-V+c,z=S-R+c,B=_-U+c,G=b-P+c,Y=x-W+2*c,K=S-C+2*c,X=_-k+2*c,J=b-I+2*c,Q=x-L+3*c,Z=S-j+3*c,$=_-D+3*c,tt=b-q+3*c,et=x-1+4*c,rt=S-1+4*c,nt=_-1+4*c,at=b-1+4*c,ut=255&h,it=255&v,ot=255&m,ct=255&y,st=d[ut+d[it+d[ot+d[ct]]]]%32,ft=d[ut+V+d[it+R+d[ot+U+d[ct+P]]]]%32,lt=d[ut+W+d[it+C+d[ot+k+d[ct+I]]]]%32,dt=d[ut+L+d[it+j+d[ot+D+d[ct+q]]]]%32,pt=d[ut+1+d[it+1+d[ot+1+d[ct+1]]]]%32,ht=.5-x*x-S*S-_*_-b*b;0>ht?a=0:(ht*=ht,a=ht*ht*u(f[st],x,S,_,b));var vt=.5-F*F-z*z-B*B-G*G;0>vt?i=0:(vt*=vt,i=vt*vt*u(f[ft],F,z,B,G));var mt=.5-Y*Y-K*K-X*X-J*J;0>mt?o=0:(mt*=mt,o=mt*mt*u(f[lt],Y,K,X,J));var yt=.5-Q*Q-Z*Z-$*$-tt*tt;0>yt?s=0:(yt*=yt,s=yt*yt*u(f[dt],Q,Z,$,tt));var Ot=.5-et*et-rt*rt-nt*nt-at*at;return 0>Ot?l=0:(Ot*=Ot,l=Ot*Ot*u(f[pt],et,rt,nt,at)),72.37855765153664*(a+i+o+s+l)},r.prototype.spherical2D=function(t,e,r){var n=e/t,a=r/t,u=2*n*Math.PI,i=a*Math.PI,o=Math.sin(i+Math.PI),c=2*Math.PI,s=c*Math.sin(u)*o,f=c*Math.cos(u)*o,l=c*Math.cos(i);return this.in3D(s,f,l)},r.prototype.spherical3D=function(t,e,r,n){var a=e/t,u=r/t,i=2*a*Math.PI,o=u*Math.PI,c=Math.sin(o+Math.PI),s=2*Math.PI,f=s*Math.sin(i)*c,l=s*Math.cos(i)*c,d=s*Math.cos(o);return this.in4D(f,l,d,n)}},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t){return{type:d,value:t}}function u(t){var e=s["default"][t.move],r={x:t.position.x+e.x,y:t.position.y+e.y};return r&&(t=l["default"].move(t,r)),o["default"].detach(t,d)}var i=r(5),o=n(i),c=r(9),s=n(c),f=r(8),l=n(f),d="MOVE";t.exports={create:a,perform:u,type:d}},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t){var e=[],r=[],n=t.state.entities.map(function(n){if(!n.move||!n.position)return n;var a=E["default"].tileTo(t.world,n.move,n.position);if(null===a)return i["default"].detach(n,d["default"].type);if(i["default"].has(n,m["default"].type)&&!n.moveRestriction(n,a))return i["default"].detach(n,d["default"].type);if("Carl"===n.name){var u=O["default"].from(n.position,n.move);f["default"].entitiesAt(t,u).filter(function(t){return t.hasOwnProperty("name")}).forEach(function(t){e=e.concat("You encounter a "+t.name+".")})}if(i["default"].has(n,h["default"].type)&&(n=n.moveEvent(n,a)),n=d["default"].perform(n),i["default"].has(n,x["default"].type)){var o=f["default"].entitiesAt(t,n.position);o.length&&i["default"].has(o[0],c["default"].type)&&(n=n.suckle(n,o[0]),r=r.concat(o[0]))}return n}).filter(function(t){return!r.includes(t)});return Object.assign({},t.state,{entities:n,messages:t.state.messages.concat(e)})}var u=r(5),i=n(u),o=r(4),c=n(o),s=r(32),f=n(s),l=r(30),d=n(l),p=r(18),h=n(p),v=r(19),m=n(v),y=r(8),O=n(y),g=r(20),M=(n(g),r(28)),E=n(M),T=r(22),x=n(T);t.exports={run:a}},function(t,e){"use strict";function r(t,e){return t.state.entities.filter(function(t){return t.hasOwnProperty("position")}).filter(function(t){return t.position.x===e.x&&t.position.y===e.y})}t.exports={entitiesAt:r}},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,e,r){return t.filter(function(t){if(!t.hasOwnProperty("avatar")||!t.hasOwnProperty("position"))return!1;var n=t.position;return n.x>=e.x&&n.x<=r.x&&n.y>=e.y&&n.y<=r.y})}function u(t){var e=t.state,r=t.world,n=(0,l.find)("#Field"),u=n.getContext("2d");u.clearRect(0,0,n.width,n.height),u.font="20px monospace";for(var i=o["default"].find(e.entities),c=i.position,s=n.width%20,d=n.height%20,p=s>0?s-20:0,h=d>0?d-20:0,v=Math.ceil(n.width/20),m=Math.ceil(n.height/20),y=Math.ceil((v-1)/2),O=Math.ceil((m-1)/2),g={x:c.x-y,y:c.y-O},M={x:g.x+v-1,y:g.y+m-1},E=a(e.entities,g,M),T=void 0,x=void 0,S=void 0,_=void 0,b=void 0,w=void 0,H=void 0,A=0;v>A;A++)for(var N=0;m>N;N++)if(w=c.x+A-y,H=c.y+N-O,x=20*A+p,S=20*N+h,!(0>w||w>=r.width||0>H||H>=r.height)){b=f["default"].tileAt(r,{x:w,y:H}),u.fillStyle=b.backgroundColor,u.fillRect(x,S,20,20),_=E.filter(function(t){return t.position.x===w&&t.position.y===H});var V=_.length>0?_.reduce(function(t,e){return e.avatar.importance>t.avatar.importance?e:t}):null;T=V?V.avatar:b.avatar,u.fillStyle=T.style,u.fillText(T.character,x+4,S+16)}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=u;var i=r(11),o=n(i),c=r(5),s=(n(c),r(28)),f=n(s),l=r(34)},function(t,e){"use strict";function r(t){var e=arguments.length<=1||void 0===arguments[1]?document:arguments[1];return e.querySelector(t)}function n(t,e){var r=arguments.length<=2||void 0===arguments[2]?[]:arguments[2],n=document.createElement(t);return Object.keys(e).forEach(function(t){n.setAttribute(t,e[t])}),r.map(function(t){return"number"==typeof t||"string"==typeof t?a(t):t}).forEach(function(t){return n.appendChild(t)}),n}function a(t){return document.createTextNode(t)}t.exports={find:r,html:n,text:a}},function(t,e,r){"use strict";function n(t){var e=t.state.messages,r=(0,a.html)("div",{id:"Message"},[e.length>0?e[e.length-1]:(0,a.html)("p",{})]);document.body.replaceChild(r,(0,a.find)("#Message"))}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=n;var a=r(34)},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t){var e=t.state,r=i["default"].find(e.entities),n=(0,s.html)("span",{"class":"energy"});n.style.width=100*r.energy.current/r.energy.max+"%";var a=(0,s.html)("div",{id:"Status"},[(0,s.html)("span",{"class":"stats"},[r.health.current+"/"+r.health.max+"HP",(0,s.html)("span",{"class":"cpu"},[(0,s.text)("CPU:")]),r.cpuSlot.cpu.clockSpeed.toFixed(1)+"GHz"]),(0,s.html)("span",{"class":"energy-bar"},[n])]);document.body.replaceChild(a,(0,s.find)("#Status"))}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=a;var u=r(11),i=n(u),o=r(5),c=(n(o),r(6)),s=(n(c),r(34))}]);